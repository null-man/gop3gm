<!DOCTYPE html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>共享数据</title>

  </head>

  <body class="bg-white font-sans">
    https://api.chatanywhere.com.cn
    sk-sgYbfA95EqiSdlSIBco2LqH3B4jL06Wbi7iIxtDQRTqR6mnF<br/>
    你是一个高级软件工程师，你需要帮我解答各种技术难题、设计技术方案以及编写代码。你编写的代码必须可以正常运行，而且没有任何 Bug 和其他问题。如果你的回答中用代码，请用 markdown 代码块，并且在代码块中标明使用的编程语言。<br/>
    <pre>
        .版本 2

.子程序 _启动窗口_创建完毕
    截图并识别金额()

.子程序 截图并识别金额
    .局部变量 窗口句柄, 整数型
    .局部变量 截图文件路径, 文本型
    .局部变量 识别结果, 文本型

    窗口句柄 ＝ 查找窗口 ("目标软件窗口标题")  // 替换为目标软件的窗口标题
    .如果 窗口句柄 ＝ 0
        信息框 ("未找到目标窗口！", , "错误")
        结束
    .结束

    截图文件路径 ＝ "C:\\temp\\screenshot.png"  // 设置截图文件路径

    // 截取窗口
    截取窗口 (窗口句柄, 截图文件路径)

    // 使用OCR识别金额
    识别结果 ＝ OCR识别 (截图文件路径)

    信息框 ("识别的客户金额为：" + 识别结果, , "识别结果")

.子程序 截取窗口 (窗口句柄, 文件路径)
    .局部变量 窗口矩形, 矩形型
    .局部变量 bitmap, 整数型
    窗口矩形 ＝ 获取窗口矩形 (窗口句柄)  // 获取窗口的矩形区域

    bitmap ＝ 创建位图 (窗口矩形.右 - 窗口矩形.左, 窗口矩形.下 - 窗口矩形.上)
    .如果 bitmap
        保存位图 (bitmap, 文件路径)
    .否则
        信息框 ("截图失败！", , "错误")
    .结束

.子程序 OCR识别 (文件路径)  // 使用Tesseract进行OCR
    .局部变量 识别文本, 文本型
    .局部变量 OCR引擎, 整数型

    // 初始化Tesseract OCR引擎
    OCR引擎 ＝ Tesseract_初始化 ("C:\\Program Files\\Tesseract-OCR\\tessdata", "chi_sim")  // 根据实际路径调整

    识别文本 ＝ Tesseract_识别 (OCR引擎, 文件路径)

    Tesseract_释放 (OCR引擎)  // 释放OCR引擎

    返回 识别文本

    </pre>
    </body>
</html>
